(window.webpackJsonp=window.webpackJsonp||[]).push([[106],{367:function(t,a,s){"use strict";s.r(a);var e=s(27),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h3",{attrs:{id:"数据代理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#数据代理"}},[t._v("#")]),t._v(" 数据代理")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("数据代理： 通过一个对象代理对另一个对象中属性的操作（读、写）")])]),t._v(" "),s("li",[s("p",[t._v("vue 数据代理： 通过 vm 对象来代理 data 对象中所有属性的操作")])]),t._v(" "),s("li",[s("p",[t._v("好处： 更方便的操作 data 中的数据")])]),t._v(" "),s("li",[s("p",[t._v("基本现流程：")]),t._v(" "),s("ul",[s("li",[t._v("通过 Object.defineProperty()给 vm 添加与 data 对象的属性对应的属性描述符")]),t._v(" "),s("li",[t._v("所有添加的属性都包含 getter、setter")]),t._v(" "),s("li",[t._v("getter、setter 内部去操作 data 中对应的属性数据")])])])]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" vm "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  el"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#app'")]),t._v("\n  data"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'111'")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 111 vm代理对data数据的读操作")]),t._v("\nvm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'aaa'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// vm代理对data数据的写操作")]),t._v("\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// aaa")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br")])]),s("h3",{attrs:{id:"模板解析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#模板解析"}},[t._v("#")]),t._v(" 模板解析")]),t._v(" "),s("h4",{attrs:{id:"模板解析的基本流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#模板解析的基本流程"}},[t._v("#")]),t._v(" 模板解析的基本流程")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("将 el 的所有子节点取出，添加到一个新建的文档 fragment 对象中")])]),t._v(" "),s("li",[s("p",[t._v("对 fragment 中的所有层次自己点递归进行编译解析处理")]),t._v(" "),s("ul",[s("li",[t._v("对表达式文本节点进行解析")]),t._v(" "),s("li",[t._v("对元素及诶单的指令属性进行解析\n"),s("ul",[s("li",[t._v("事件指令解析")])])])])])]),t._v(" "),s("h4",{attrs:{id:"模板解析（1）大括号表达式解析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#模板解析（1）大括号表达式解析"}},[t._v("#")]),t._v(" 模板解析（1）大括号表达式解析")]),t._v(" "),s("ol",[s("li",[t._v("根据正则对象得到匹配出的表达式字符串：子匹配、Exg.$l")]),t._v(" "),s("li",[t._v("从 data 中取出表达式对应的属性值")]),t._v(" "),s("li",[t._v("将属性值设置为文本节点的 textContent")])]),t._v(" "),s("h4",{attrs:{id:"模板解析（2）事件指令解析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#模板解析（2）事件指令解析"}},[t._v("#")]),t._v(" 模板解析（2）事件指令解析")]),t._v(" "),s("ol",[s("li",[t._v("从指令中取出事件名")]),t._v(" "),s("li",[t._v("根据指令的值（表达式）从 methods 中得到对应的事件处理函数对象")]),t._v(" "),s("li",[t._v("给当前元素节点绑定指定事件名和回调函数的 dom 事件监听")]),t._v(" "),s("li",[t._v("指令解析完后，移除此指令属性")])]),t._v(" "),s("h4",{attrs:{id:"模板解析（3）-一般指令解析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#模板解析（3）-一般指令解析"}},[t._v("#")]),t._v(" 模板解析（3） 一般指令解析")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("得到指令名和指令值（表达式） text、html、class")])]),t._v(" "),s("li",[s("p",[t._v("从 data 中更加表达式得到对应的值")])]),t._v(" "),s("li",[s("p",[t._v("根据指令名确认需要操作元素节点的什么属性")]),t._v(" "),s("ul",[s("li",[t._v("v-text —— textContent 属性")]),t._v(" "),s("li",[t._v("v-html ——innerHtml 属性")]),t._v(" "),s("li",[t._v("c-class —— className 属性")])])]),t._v(" "),s("li",[s("p",[t._v("将得到的表达式的值设置到对应的属性上")])]),t._v(" "),s("li",[s("p",[t._v("移除元素的指令属性")])])]),t._v(" "),s("h3",{attrs:{id:"数据绑定"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#数据绑定"}},[t._v("#")]),t._v(" 数据绑定")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("数据绑定\n一旦更新了 data 中的某个属性数据，所有界面上直接使用或间接使用了此属性的节点都会更新")])]),t._v(" "),s("li",[s("p",[t._v("数据劫持")]),t._v(" "),s("ul",[s("li",[t._v("数据劫持是 vue 中用来实现数据绑定的一种技术")]),t._v(" "),s("li",[t._v("基本思想：通过 Object.definedProperty 来监视 data 中所有属性（任意层次）数据的变化，一旦变化就去更新界面")])])])]),t._v(" "),s("h3",{attrs:{id:"dep"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dep"}},[t._v("#")]),t._v(" Dep")]),t._v(" "),s("p",[t._v("Dep 的实例什么时候创建？ 初始化的给 data 的属性进行数据劫持时创建的。")]),t._v(" "),s("p",[t._v("Dep 的个数？ 与 data 中的属性一一对应")]),t._v(" "),s("p",[t._v("Dep 的结构？id: 标识; subs（数组）: n 个相关的 watcher 的容器")]),t._v(" "),s("h3",{attrs:{id:"watcher"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#watcher"}},[t._v("#")]),t._v(" watcher")]),t._v(" "),s("p",[t._v("watcher 的实例是什么时候创建？初始化的解析大括号表达式、一般指令时创建")]),t._v(" "),s("p",[t._v("watcher 的个数？ 与模板中表达式（非时间指令）一一对应")]),t._v(" "),s("p",[t._v("watcher 的结构？")]),t._v(" "),s("ul",[s("li",[t._v("this.cb = cb; // 用于更新界面的回调")]),t._v(" "),s("li",[t._v("this.vm = vm; //vm")]),t._v(" "),s("li",[t._v("this.exp = exp; // 对应的表达式")]),t._v(" "),s("li",[t._v("this.depIds = {}; // 相关的 n 个 dep 的容器对象")]),t._v(" "),s("li",[t._v("this.value = this.get(); // 当前表达式对应的 value")])]),t._v(" "),s("h4",{attrs:{id:"dep-与-watcher-之间的关系"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dep-与-watcher-之间的关系"}},[t._v("#")]),t._v(" Dep 与 watcher 之间的关系")]),t._v(" "),s("p",[t._v("Dep 与 watcher 关系：多对多的关系。")]),t._v(" "),s("ul",[s("li",[t._v("data 属性 => Dep => n 个 watcher（模板中有多个表达式使用了此属性： "+t._s(t.a)+' v-text="a"）')]),t._v(" "),s("li",[t._v("表达式 => watcher => n 个 Dep（多层表达式： a.b.c， 一个 watcher，3 个 Dep a/b/c）")])]),t._v(" "),s("p",[t._v("vm.name = 'abc' => data 中的 name 属性值变化 => name 的 set()调用 => dep => 相关的所有 watcher => cb() => updater")]),t._v(" "),s("p",[t._v("Dep 与 watcher 之间的关系如何建立？data 中属性的 get()中建立")]),t._v(" "),s("p",[t._v("Dep 与 watcher 之间的关系什么时候建立？ 初始化的解析模板中的表达式创建对象时")])])}),[],!1,null,null,null);a.default=n.exports}}]);